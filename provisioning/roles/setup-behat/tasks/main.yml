---
# Ansible role setups up Behat tests to run with BLT
# https://github.com/SU-SWS/drupal-caravan
# ==================================================
#
# The purpose of this role is to instantiate a STATE, in this case
# the presence of Stanford's custom Behat step definitions.
#
# INPUTS:
#   sitename
#   container_webserver_root
#
# OUTPUTS:
# --
#
# ALTERNATIVE ROLES:
# --
#
# REQUIREMENTS:
# Acquia BLT in vendor directory.
#
# KNOWN ISSUES:
# - We'd like to eventually replace this task by simply including linky_clicky
#   as a Caravan dependency in composer.json, however that requires updating
#   the linky_clicky default branch from 5.x to 6.x, which would disrupt many
#   things, like stanford_travisci_scripts.

- name: Download linky_clicky
  git:
    repo: "https://github.com/SU-SWS/linky_clicky.git"
    dest: "{{ container_webserver_root }}{{ sitename }}/vendor/su-sws/linky_clicky"
    version: 6.x
    update: yes

- name: Copy behat config file
  template:
    src: behat.blt.yml.j2
    dest: "{{ container_webserver_root }}{{ sitename }}/vendor/su-sws/linky_clicky/behat.blt.yml"
